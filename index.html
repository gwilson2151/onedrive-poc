<html>
<head>
	<title>OneDrive Picker Playground</title>
	<script type="text/javascript" src="https://js.live.net/v7.2/OneDrive.js"></script>
</head>
	<body>
		<button onclick="choose();" type="button">Choose</button>
		<script>
		var choose = (function() {
			var options = {
				clientId: '87d16201-65d3-4bc3-95ad-40125eeee49b',
				action: 'download',
				advanced: {
					filter: '.png,.jpg,.jpeg,.tiff',
					redirectUri: 'https://dev.local:8443/onedrive_picker_redirect.html'
				},
				success: function(response) {
					console.log(response);
					alert(response.value[0]["@microsoft.graph.downloadUrl"]);
				},
				cancel: function() {
					console.log("cancelled");
				},
				error: function(e) {
					console.log(e);
				}
			};
			
			return function() {OneDrive.open(options);};
		})();
		</script>
	</body>
</html>